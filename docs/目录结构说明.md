# 项目目录结构

## 整体架构

```
chatgpt2word/
├── api/                          # 后端 API 服务
│   ├── main.py                   # FastAPI 应用入口
│   ├── requirements.txt          # Python 依赖
│   ├── Dockerfile               # API 容器化配置
│   ├── docker-compose.yml       # 服务编排配置
│   ├── handlers/                 # 业务处理模块
│   │   ├── conversion_handler.py
│   │   └── route_handler.py
│   ├── services/                 # 核心服务
│   │   ├── pandoc_service.py
│   │   └── cache_service.py
│   └── utils/                    # 工具函数
│       ├── html_validator.py
│       └── file_manager.py
│
├── extension/                    # 浏览器插件
│   ├── chrome/                   # Chrome 插件
│   │   ├── manifest.json         # 插件清单 (Manifest V3)
│   │   ├── background.js         # 后台脚本
│   │   ├── content.js            # 内容脚本 (注入 ChatGPT 页面)
│   │   ├── popup/                # 弹窗 UI
│   │   │   ├── popup.html
│   │   │   ├── popup.js
│   │   │   └── popup.css
│   │   ├── options.html          # 设置页面
│   │   └── icons/                # 插件图标
│   ├── firefox/                  # Firefox 插件 (可选)
│   │   ├── manifest.json
│   │   └── ... (类似 chrome)
│   └── shared/                   # 插件共用代码
│       └── chatgpt-parser.js     # ChatGPT HTML 解析
│
├── docs/examples/               # 示例文件
│   ├── sample-html.html          # ChatGPT HTML 示例
│   └── api-request.http          # API 请求示例 (HTTP)
│
├── shared/                       # 仅存放文档约定（代码无法真正共享）
│   └── README.md                 # 说明：API 格式和错误码约定
│
├── docs/                         # 项目文档
│   ├── API设计方案.md            # API 设计方案
│   ├── CLAUDE.md                 # Claude Code 指南
│   ├── 安装指南.md               # 安装部署指南
│   └── 开发指南.md               # 开发者文档
│
├── tests/                        # 测试文件
│   ├── api/                      # API 测试
│   │   └── test_conversion.py
│   └── extension/                # 插件测试
│       └── test_content_script.ts
│
├── scripts/                      # 构建和部署脚本
│   ├── build-api.sh              # 构建 API
│   ├── build-extension.sh        # 构建插件
│   └── deploy.sh                 # 部署脚本
│
├── .github/                      # GitHub 配置
│   └── workflows/                # CI/CD 流水线
│       └── build-and-publish.yml
│
├── .gitignore
├── README.md
└── LICENSE
```

## 目录说明

### `/api` - 后端 API 服务
- **语言**: Python
- **框架**: FastAPI + Uvicorn
- **功能**: HTML → Word 转换服务
- **部署**: Docker 容器化

### `/extension` - 浏览器插件
- **支持浏览器**: Chrome (主要), Firefox (可选)
- **功能**: 提取 ChatGPT HTML，调用 API，下载 Word 文件
- **用户界面**: 弹窗 + 设置页面

### `/shared` - 共享代码
- **语言**: TypeScript (用于插件), 通用 (工具函数)
- **用途**: 减少重复代码，保持插件和 API 间的类型一致

### `/docs` - 项目文档
- 设计方案、安装指南、开发文档等

### `/tests` - 测试
- API 单元测试
- 插件功能测试

### `/scripts` - 构建脚本
- 自动化构建和部署流程

## 优势

✅ **统一代码库** - 插件和 API 在同一个仓库
✅ **类型安全** - shared/types 保证两端类型一致
✅ **易于维护** - 共享工具函数，避免重复实现
✅ **CI/CD 友好** - 单一仓库流水线自动化
✅ **版本同步** - 插件和 API 的修改可以一起发布
✅ **便于调试** - 统一日志和错误处理

## 开发流程

1. **开发 API**: 在 `/api` 目录修改 FastAPI 代码
2. **开发插件**: 在 `/extension` 目录修改浏览器插件
3. **共享代码**: 在 `/shared` 目录维护公共部分
4. **编写文档**: 在 `/docs` 目录更新说明
5. **提交测试**: 在 `/tests` 目录添加测试
6. **部署发布**: 使用 `/scripts` 目录的脚本自动化
