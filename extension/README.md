# ChatGPT HTML to Word Converter - Chrome Extension

## 📋 概述

这是一个Chrome浏览器扩展程序，用于将ChatGPT导出的包含KaTeX数学公式的HTML内容转换为Word文档或PDF文档。

## 📁 文件结构

```
extension/
├── manifest.json          # 扩展配置文件
├── popup.html             # 弹窗界面
├── popup.css              # 弹窗样式
├── popup.js               # 弹窗逻辑
├── background.js          # 后台服务脚本
├── icons/                 # 图标目录（需创建）
│   ├── icon16.png         # 16x16 图标
│   ├── icon48.png         # 48x48 图标
│   └── icon128.png        # 128x128 图标
└── README.md              # 本文档
```

## 🎨 图标文件要求

### 所需图标文件

请在 `extension/icons/` 目录下创建以下图标文件：

1. **icon16.png** (16x16 像素)
   - 用途：浏览器工具栏显示
   - 格式：PNG
   - 建议：简洁的转换器或文档图标

2. **icon48.png** (48x48 像素)
   - 用途：扩展管理页面
   - 格式：PNG
   - 建议：与16px版本相同，但更清晰

3. **icon128.png** (128x128 像素)
   - 用途：Chrome Web Store（如果发布）
   - 格式：PNG
   - 建议：高清版本，支持多分辨率

### 图标设计建议

- **主题**：文档转换、HTML到Word转换
- **颜色**：建议使用蓝色系（与界面主题色一致）
- **元素**：可包含文档图标、箭头、转换符号等
- **风格**：扁平化或轻微阴影，现代简洁风格

### 快速获取图标的简单方案

如果您暂时没有图标文件，可以使用以下任一方法：

1. **临时方案**：使用任何16x16、48x48、128x128的PNG图片作为占位符
2. **在线工具**：使用 [Favicon.io](https://favicon.io/) 或 [Canva](https://www.canva.com/) 生成
3. **简单图标**：创建简单的蓝色方块或使用字母 "C"（代表ChatGPT Converter）作为图标

**注意**：即使没有图标，扩展也可以正常运行，但建议尽快添加适当图标以获得最佳用户体验。

## 🚀 安装步骤

### 方法一：开发者模式安装（推荐）

1. **打开Chrome扩展管理页面**
   - 地址栏输入：`chrome://extensions/`
   - 或通过菜单：更多工具 → 扩展程序

2. **启用开发者模式**
   - 在页面右上角启用"开发者模式"开关

3. **加载扩展**
   - 点击"加载已解压的扩展程序"按钮
   - 选择 `extension` 文件夹
   - 点击"选择文件夹"

4. **验证安装**
   - 扩展列表中应出现"ChatGPT HTML to Word Converter"
   - 浏览器工具栏出现扩展图标

### 方法二：打包安装

1. **打包扩展**
   - 在扩展管理页面点击"打包扩展程序"
   - 选择 `extension` 目录
   - 生成 `.crx` 文件

2. **安装打包文件**
   - 将 `.crx` 文件拖拽到扩展管理页面
   - 确认安装

## ⚙️ 配置说明

### 首次使用

1. **启动API服务**
   - 确保后端API服务正在运行
   - 默认地址：http://localhost:8000

2. **打开扩展**
   - 点击浏览器工具栏中的扩展图标
   - 弹出转换界面

3. **配置API地址**
   - 在"API地址"输入框中输入您的API地址
   - 默认：http://localhost:8000
   - 设置会自动保存

### 主要功能

- **HTML内容输入**：粘贴ChatGPT导出的HTML内容
- **文件名设置**：设置输出文档的文件名（可选）
- **格式选择**：选择输出格式（Word .docx 或 PDF .pdf）
- **实时验证**：自动检测HTML中的KaTeX数学公式
- **状态显示**：显示转换进度和结果
- **错误提示**：详细的错误信息和解决建议

## 🔧 使用方法

1. **复制HTML内容**
   - 从ChatGPT导出HTML文件
   - 或复制网页中的HTML内容

2. **粘贴到扩展**
   - 打开扩展弹窗
   - 将HTML内容粘贴到文本框

3. **设置选项**
   - 输入文件名（可选）
   - 选择输出格式

4. **开始转换**
   - 点击"开始转换"按钮
   - 等待转换完成
   - 文件自动下载

## 🔍 支持的输入格式

✅ **完全支持**：
- ChatGPT导出的HTML文件
- 包含KaTeX数学公式的HTML
- 包含LaTeX公式的ChatGPT对话

❌ **不支持**：
- 纯文本（无数学公式）
- 其他格式的数学公式（MathML等）

## 🐛 常见问题

### Q: 扩展无法连接到API
**A**: 请检查：
- API服务是否正在运行
- API地址是否正确
- 是否存在网络防火墙阻止

### Q: 转换失败，提示"未检测到数学公式"
**A**: 请确认：
- 输入的是ChatGPT导出的HTML
- HTML中包含KaTeX公式
- 不是纯文本内容

### Q: 下载的文件无法打开
**A**: 请检查：
- 是否安装了兼容的Word/PDF阅读器
- 文件是否完整下载
- API转换是否成功完成

## 🔐 权限说明

扩展请求以下权限：
- `storage`：保存用户设置（API地址、文件名等）
- `host_permissions`：访问API服务（localhost:8000等）

所有数据仅在本地和您的API服务之间传输，不会上传到任何第三方服务器。

## 📝 更新日志

### v1.0.0
- 初始版本发布
- 支持HTML到Word/PDF转换
- 支持KaTeX数学公式
- 现代化的用户界面
- 自动保存设置功能

## 📞 支持

如有问题或建议，请：
1. 检查本文档的常见问题部分
2. 确认API服务正常运行
3. 检查浏览器控制台是否有错误信息

## 📄 许可证

本项目采用 MIT 许可证。
